import { retryUntil } from '../../index.js';
/**
 * Waits for the account to finish synchronizing with the PXE Service.
 * @param pxe - PXE instance
 * @param address - Address to wait for synch
 * @param opts - Wait options
 */
export async function waitForAccountSynch(pxe, address, { interval, timeout }) {
    const publicKey = address.publicKey.toString();
    await retryUntil(async () => {
        const status = await pxe.getSyncStatus();
        const accountSynchedToBlock = status.notes[publicKey];
        if (typeof accountSynchedToBlock === 'undefined') {
            return false;
        }
        else {
            return accountSynchedToBlock >= status.blocks;
        }
    }, 'waitForAccountSynch', timeout, interval);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hY2NvdW50L21hbmFnZXIvdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWtDLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTVFOzs7OztHQUtHO0FBQ0gsTUFBTSxDQUFDLEtBQUssVUFBVSxtQkFBbUIsQ0FDdkMsR0FBUSxFQUNSLE9BQXdCLEVBQ3hCLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBWTtJQUUvQixNQUFNLFNBQVMsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQy9DLE1BQU0sVUFBVSxDQUNkLEtBQUssSUFBSSxFQUFFO1FBQ1QsTUFBTSxNQUFNLEdBQUcsTUFBTSxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDekMsTUFBTSxxQkFBcUIsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3RELElBQUksT0FBTyxxQkFBcUIsS0FBSyxXQUFXLEVBQUU7WUFDaEQsT0FBTyxLQUFLLENBQUM7U0FDZDthQUFNO1lBQ0wsT0FBTyxxQkFBcUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDO1NBQy9DO0lBQ0gsQ0FBQyxFQUNELHFCQUFxQixFQUNyQixPQUFPLEVBQ1AsUUFBUSxDQUNULENBQUM7QUFDSixDQUFDIn0=