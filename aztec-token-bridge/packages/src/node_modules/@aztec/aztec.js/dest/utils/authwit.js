import { GeneratorIndex } from '@aztec/circuits.js';
import { pedersenHash } from '@aztec/foundation/crypto';
import { PackedArguments } from '@aztec/types';
// docs:start:authwit_computeAuthWitMessageHash
/**
 * Compute an authentication witness message hash from a caller and a request
 * H(caller: AztecAddress, target: AztecAddress, selector: Field, args_hash: Field)
 * @param caller - The caller approved to make the call
 * @param request - The request to be made (function call)
 * @returns The message hash for the witness
 */
export const computeAuthWitMessageHash = (caller, request) => {
    return pedersenHash([
        caller.toField(),
        request.to.toField(),
        request.functionData.selector.toField(),
        PackedArguments.fromArgs(request.args).hash,
    ].map(fr => fr.toBuffer()), GeneratorIndex.SIGNATURE_PAYLOAD);
};
// docs:end:authwit_computeAuthWitMessageHash
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aHdpdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9hdXRod2l0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0IsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDbEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3hELE9BQU8sRUFBZ0IsZUFBZSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTdELCtDQUErQztBQUMvQzs7Ozs7O0dBTUc7QUFDSCxNQUFNLENBQUMsTUFBTSx5QkFBeUIsR0FBRyxDQUFDLE1BQW9CLEVBQUUsT0FBcUIsRUFBRSxFQUFFO0lBQ3ZGLE9BQU8sWUFBWSxDQUNqQjtRQUNFLE1BQU0sQ0FBQyxPQUFPLEVBQUU7UUFDaEIsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUU7UUFDcEIsT0FBTyxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFO1FBQ3ZDLGVBQWUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUk7S0FDNUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsRUFDMUIsY0FBYyxDQUFDLGlCQUFpQixDQUNqQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBQ0YsNkNBQTZDIn0=