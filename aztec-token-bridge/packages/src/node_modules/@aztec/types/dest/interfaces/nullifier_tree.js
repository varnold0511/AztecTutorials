import { Fr } from '@aztec/circuits.js';
/**
 * Nullifier membership witness.
 * @remarks When this represents membership witness of a low nullifier it can be used to perform a nullifier
 * non-inclusion proof by leveraging the "linked list structure" of leaves and proving that a lower nullifier
 * is pointing to a bigger next value than the nullifier we are trying to prove non-inclusion for.
 */
export class NullifierMembershipWitness {
    constructor(
    /**
     * The index of the nullifier in a tree.
     */
    index, 
    /**
     * Preimage of the nullifier.
     */
    leafPreimage, 
    /**
     * Sibling path to prove membership of the nullifier.
     */
    siblingPath) {
        this.index = index;
        this.leafPreimage = leafPreimage;
        this.siblingPath = siblingPath;
    }
    /**
     * Returns a field array representation of a nullifier witness.
     * @returns A field array representation of a nullifier witness.
     */
    toFieldArray() {
        return [
            new Fr(this.index),
            new Fr(this.leafPreimage.nullifier),
            new Fr(this.leafPreimage.nextIndex),
            new Fr(this.leafPreimage.nextNullifier),
            ...this.siblingPath.toFieldArray(),
        ];
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVsbGlmaWVyX3RyZWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW50ZXJmYWNlcy9udWxsaWZpZXJfdHJlZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsRUFBRSxFQUFnRCxNQUFNLG9CQUFvQixDQUFDO0FBSXRGOzs7OztHQUtHO0FBQ0gsTUFBTSxPQUFPLDBCQUEwQjtJQUNyQztJQUNFOztPQUVHO0lBQ2EsS0FBYTtJQUM3Qjs7T0FFRztJQUNhLFlBQW1DO0lBQ25EOztPQUVHO0lBQ2EsV0FBc0Q7UUFSdEQsVUFBSyxHQUFMLEtBQUssQ0FBUTtRQUliLGlCQUFZLEdBQVosWUFBWSxDQUF1QjtRQUluQyxnQkFBVyxHQUFYLFdBQVcsQ0FBMkM7SUFDckUsQ0FBQztJQUVKOzs7T0FHRztJQUNJLFlBQVk7UUFDakIsT0FBTztZQUNMLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDbEIsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUM7WUFDbkMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUM7WUFDbkMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUM7WUFDdkMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksRUFBRTtTQUNuQyxDQUFDO0lBQ0osQ0FBQztDQUNGIn0=